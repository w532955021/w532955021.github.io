function _classCallCheck(o,r){if(!(o instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(o,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(o,n.key,n)}}function _createClass(o,r,e){return r&&_defineProperties(o.prototype,r),e&&_defineProperties(o,e),o}function _defineProperty(o,r,e){return r in o?Object.defineProperty(o,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):o[r]=e,o}!function(){var o,r={MonitorId:{ADD_MODULE:7743,HIDE_MODULE:7744,COPY_MODULE:7745,REFRESH_MODULE:7747,SWITCH_STATUS:7873,SUBMIT_FORM:7748,TAB_CONTAINER_SWITCH:7749,FOLD_CONTAINER_SWUTCH:7750,OPEN_PANEL:7751,DESIGN_SAVE:7752,ADD_PAGE:7753,OPEN_RAPID_SITE:7754},AlarmMonitorId:{ADD_MODULE:7755,HIDE_MODULE:7756,COPY_MODULE:7757,REFRESH_MODULE:7758,SWITCH_STATUS:7875,SUBMIT_FORM:7759,TAB_CONTAINER_SWITCH:7760,FOLD_CONTAINER_SWUTCH:7761,OPEN_PANEL:7762,DESIGN_SAVE:7763,ADD_PAGE:7764,OPEN_RAPID_SITE:7766,JZ_UTILS:7767}},e=r.MonitorId,n=r.AlarmMonitorId;r._AutoAlarmMonitorMap=(_defineProperty(o={},e.ADD_MODULE,n.ADD_MODULE),_defineProperty(o,e.HIDE_MODULE,n.HIDE_MODULE),_defineProperty(o,e.COPY_MODULE,n.COPY_MODULE),_defineProperty(o,e.REFRESH_MODULE,n.REFRESH_MODULE),_defineProperty(o,e.FOLD_CONTAINER_SWUTCH,n.FOLD_CONTAINER_SWUTCH),_defineProperty(o,e.TAB_CONTAINER_SWITCH,n.TAB_CONTAINER_SWITCH),_defineProperty(o,e.OPEN_PANEL,n.OPEN_PANEL),_defineProperty(o,e.DESIGN_SAVE,n.DESIGN_SAVE),_defineProperty(o,e.ADD_PAGE,n.ADD_PAGE),_defineProperty(o,e.OPEN_RAPID_SITE,n.OPEN_RAPID_SITE),o);var t=function(){function o(){_classCallCheck(this,o)}return _createClass(o,null,[{key:"startMonitor",value:function(r){var e=this;if(!r)return console.error("请传入 monitorId"),function(){};var n=new Date;return o._monitors[r]={startTime:n},function(){var o=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1?arguments[1]:void 0;return e.endMonitor(r,o,n)}}},{key:"endMonitor",value:function(r){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,t=o._monitors[r];delete o._monitors[r],t&&t.startTime&&(this.logMonitor(r,!e,new Date-t.startTime),n&&this.logErr("mobiFrontendMonitorErr, monitorId: ".concat(r,"; href: ").concat(location.href,"; errmsg:").concat(n.stack||n.toString())))}},{key:"logMonitor",value:function(o,r,e){this._sendData({monitorId:o,cmd:"wafNotCk_logMonitor",isError:r,consumeTime:e,alarmMonitorId:this._getAutoAlarmMonitorId(o)})}},{key:"logAlarmMonitor",value:function(o){this._sendData({monitorId:o,cmd:"wafNotCk_logAlarmMonitor"})}},{key:"_sendData",value:function(o){location.search.includes("monitor_log")&&console.log("监控上报",o);var r=null;if("undefined"!=typeof jQuery)r=jQuery;else{if("undefined"==typeof jm)return;r=jm}r.ajax({url:"/ajax/frontMonitor_h.jsp",type:"post",data:o,success:function(o){var r=JSON.parse(o);r.success||console.error("监控数据上报错误",r)},error:function(o){console.error("监控数据上报错误",o)}})}},{key:"logErr",value:function(o){o&&$.ajax({type:"GET",url:"/ajax/log_h.jsp?cmd=wafNotCk_err&err="+encodeURIComponent(o)})}},{key:"_getAutoAlarmMonitorId",value:function(o){return r._AutoAlarmMonitorMap[o]||0}},{key:"monitorDecorator",value:function(r){return function(e){return function(){var n,t=o.startMonitor(e);try{n=r.apply(this,arguments)}catch(o){throw t(!1,o),o}return n instanceof Promise?n.then(function(o){return t(!0),o}).catch(function(o){throw t(!1,o),o}):(t(!0),n)}}}}]),o}();t._monitors={},window.Monitor=t,window.MonitorDef=r,Function.prototype.bindMonitor=function(o){return t.monitorDecorator(this)(o)}}();